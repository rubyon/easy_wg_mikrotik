<div class="wg-login-container">
  <!-- 로그인 카드 -->
  <div class="wg-login-card">
    <!-- 헤더 섹션 -->
    <div class="wg-login-header">
      <div class="wg-login-icon">
        <svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"></path>
        </svg>
      </div>
      <h2 class="wg-login-title"><%= t('login.title') %></h2>
      <p class="wg-login-subtitle"><%= t('login.subtitle') %></p>
    </div>

  <%
    # 저장된 로그인 정보가 있으면 로드
    saved_login = nil
    if cookies[:remember_mikrotik_login].present?
      begin
        saved_login = JSON.parse(cookies[:remember_mikrotik_login])
      rescue JSON::ParserError
        # 쿠키가 손상된 경우 무시
      end
    end
  %>

    <!-- 로그인 폼 -->
    <%= form_with url: login_path, method: :post, local: true, class: "space-y-6", data: { turbo: false } do |f| %>
      <!-- 호스트와 포트를 한 줄에 -->
      <div class="grid grid-cols-1 sm:grid-cols-3 gap-4">
        <div class="wg-form-group sm:col-span-2">
          <%= f.label :mikrotik_host, class: "wg-label group-focus-within:text-wg-primary transition-colors" do %>
            <span class="flex items-center space-x-2">
              <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 12h14M5 12a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v4a2 2 0 01-2 2M5 12a2 2 0 00-2 2v4a2 2 0 002 2h14a2 2 0 002-2v-4a2 2 0 00-2-2"></path>
              </svg>
              <span><%= t('login.host_label') %></span>
            </span>
          <% end %>
          <%= f.text_field :mikrotik_host,
                value: saved_login&.dig("host"),
                placeholder: t('login.host_placeholder'),
                class: "wg-input hover:bg-gray-50 group-focus-within:bg-white",
                required: true %>
        </div>

        <div class="wg-form-group">
          <%= f.label :mikrotik_port, class: "wg-label group-focus-within:text-wg-primary transition-colors" do %>
            <span class="flex items-center space-x-2">
              <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 9l3 3-3 3m5 0h3M5 20h14a2 2 0 002-2V6a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"></path>
              </svg>
              <span><%= t('login.port_label') %></span>
            </span>
          <% end %>
          <%= f.number_field :mikrotik_port,
                value: saved_login&.dig("port") || "8728",
                class: "wg-input hover:bg-gray-50 group-focus-within:bg-white" %>
        </div>
      </div>

      <!-- 사용자명 -->
      <div class="wg-form-group">
        <%= f.label :mikrotik_user, class: "wg-label group-focus-within:text-wg-primary transition-colors" do %>
          <span class="flex items-center space-x-2">
            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path>
            </svg>
            <span><%= t('login.username_label') %></span>
          </span>
        <% end %>
        <%= f.text_field :mikrotik_user,
              value: saved_login&.dig("user"),
              placeholder: t('login.username_placeholder'),
              class: "wg-input hover:bg-gray-50 group-focus-within:bg-white",
              required: true %>
      </div>

      <!-- 비밀번호 -->
      <div class="wg-form-group">
        <%= f.label :mikrotik_password, class: "wg-label group-focus-within:text-wg-primary transition-colors" do %>
          <span class="flex items-center space-x-2">
            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path>
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"></path>
            </svg>
            <span><%= t('login.password_label') %></span>
          </span>
        <% end %>
        <%= f.password_field :mikrotik_password,
              class: "wg-input hover:bg-gray-50 group-focus-within:bg-white",
              required: true %>
      </div>

      <!-- Remember Me 체크박스 -->
      <div class="flex items-center justify-between pt-2">
        <label class="flex items-center space-x-3 cursor-pointer group">
          <%= check_box_tag :remember_me, "1", saved_login.present?,
                class: "w-5 h-5 text-wg-primary bg-gray-100 border-2 border-wg-border rounded focus:ring-wg-primary focus:ring-2 transition-all duration-200" %>
          <span class="text-sm font-medium text-wg-gray group-hover:text-wg-dark transition-colors">
            <%= t('login.remember_label') %>
          </span>
        </label>
      </div>

      <!-- 로그인 버튼 -->
      <div class="pt-4">
        <%= f.submit t('login.login_button'), class: "wg-btn-primary w-full py-4 px-6 font-semibold" %>
      </div>
    <% end %>

    <!-- 안내 메시지 -->
    <div class="mt-8 text-center">
      <div class="inline-flex items-center space-x-2 px-4 py-2 bg-blue-50/50 rounded-full border border-gray-300">
        <svg class="w-4 h-4 text-wg-primary" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
        </svg>
        <span class="text-sm font-medium text-wg-primary"><%= t('login.api_info') %></span>
      </div>
    </div>
  </div>

  <!-- 장식적 요소 -->
  <div class="wg-decorative-bg"></div>
</div>
